<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TaleTeller</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" id="splashFonts" as="style" href="https://fonts.googleapis.com/css2?family=Basic&family=Caesar+Dressing&family=Eater&family=Henny+Penny&family=Kablammo&family=Libre+Baskerville&family=Mystery+Quest&family=Pacifico&family=Rubik+Gemstones&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Basic&family=Caesar+Dressing&family=Eater&family=Henny+Penny&family=Kablammo&family=Libre+Baskerville&family=Mystery+Quest&family=Pacifico&family=Rubik+Gemstones&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">

</head>
<body>
  <div id="splash-screen">
    <h1 id="product-name">&nbsp;</h1>
  </div>

  <iframe id="textFrame" src="/story.txt" style="display: none;"></iframe>

  <header>
    <button id="reloadButton" class="svgHeaderButton">
      <div><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: currentColor;">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M13.7071 1.29289C14.0976 1.68342 14.0976 2.31658 13.7071 2.70711L12.4053 4.00896C17.1877 4.22089 21 8.16524 21 13C21 17.9706 16.9706 22 12 22C7.02944 22 3 17.9706 3 13C3 12.4477 3.44772 12 4 12C4.55228 12 5 12.4477 5 13C5 16.866 8.13401 20 12 20C15.866 20 19 16.866 19 13C19 9.2774 16.0942 6.23349 12.427 6.01281L13.7071 7.29289C14.0976 7.68342 14.0976 8.31658 13.7071 8.70711C13.3166 9.09763 12.6834 9.09763 12.2929 8.70711L9.29289 5.70711C9.10536 5.51957 9 5.26522 9 5C9 4.73478 9.10536 4.48043 9.29289 4.29289L12.2929 1.29289C12.6834 0.902369 13.3166 0.902369 13.7071 1.29289Z"></path>
      </svg></div>  
    </button>
  <!-- 
    <button id="shareButton" class="svgHeaderButton">
      <img src="img/share.svg" alt="Share Button Image" />
    </button>
-->
    <button id="optionsButton" class="svgHeaderButton">
      <div><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: currentColor;">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M12.7848 0.449982C13.8239 0.449982 14.7167 1.16546 14.9122 2.15495L14.9991 2.59495C15.3408 4.32442 17.1859 5.35722 18.9016 4.7794L19.3383 4.63233C20.3199 4.30175 21.4054 4.69358 21.9249 5.56605L22.7097 6.88386C23.2293 7.75636 23.0365 8.86366 22.2504 9.52253L21.9008 9.81555C20.5267 10.9672 20.5267 13.0328 21.9008 14.1844L22.2504 14.4774C23.0365 15.1363 23.2293 16.2436 22.7097 17.1161L21.925 18.4339C21.4054 19.3064 20.3199 19.6982 19.3382 19.3676L18.9017 19.2205C17.1859 18.6426 15.3408 19.6754 14.9991 21.405L14.9122 21.845C14.7167 22.8345 13.8239 23.55 12.7848 23.55H11.2152C10.1761 23.55 9.28331 22.8345 9.08781 21.8451L9.00082 21.4048C8.65909 19.6754 6.81395 18.6426 5.09822 19.2205L4.66179 19.3675C3.68016 19.6982 2.59465 19.3063 2.07505 18.4338L1.2903 17.1161C0.770719 16.2436 0.963446 15.1363 1.74956 14.4774L2.09922 14.1844C3.47324 13.0327 3.47324 10.9672 2.09922 9.8156L1.74956 9.52254C0.963446 8.86366 0.77072 7.75638 1.2903 6.8839L2.07508 5.56608C2.59466 4.69359 3.68014 4.30176 4.66176 4.63236L5.09831 4.77939C6.81401 5.35722 8.65909 4.32449 9.00082 2.59506L9.0878 2.15487C9.28331 1.16542 10.176 0.449982 11.2152 0.449982H12.7848ZM12 15.3C13.8225 15.3 15.3 13.8225 15.3 12C15.3 10.1774 13.8225 8.69998 12 8.69998C10.1774 8.69998 8.69997 10.1774 8.69997 12C8.69997 13.8225 10.1774 15.3 12 15.3Z"></path>
      </svg></div>  
    </button>

    <div id="arrows" class="centeredButtons">
      <button id="prev">&lt;</button>
      <input type="text" id="indicator" value="1" maxlength="3">
      <button id="next">&gt;</button>
    </div>
    
    <div id="totalPageContainer">of&nbsp;<span id="totalPages">1</span>&nbsp;pages</div>

    <button id="fullscreenButton" class="svgHeaderButton">
      <div><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="fill: currentColor;">
        <path d="M9.707 9.71c-.2.19-.45.29-.71.29-.26 0-.51-.1-.71-.29L3.5 4.92l-.35.34-1.44 1.45C1.51 6.9 1.26 7 1 7c-.13 0-.26-.03-.38-.08C.24 6.77 0 6.4 0 6V1c0-.55.45-1 1-1h5c.4 0 .77.24.92.62.16.37.07.8-.21 1.09L5.26 3.15l-.34.35 4.788 4.79c.39.39.39 1.03 0 1.42zM14.293 9.71c.2.19.45.29.71.29.26 0 .51-.1.71-.29l4.79-4.79.35.34 1.44 1.45c.197.19.447.29.707.29.13 0 .26-.03.38-.08.38-.15.62-.52.62-.92V1c0-.55-.45-1-1-1h-5c-.4 0-.77.24-.92.62-.16.37-.07.8.21 1.09l1.45 1.44.34.35-4.788 4.79c-.39.39-.39 1.03 0 1.42zM9.707 14.29c-.2-.19-.45-.29-.71-.29-.26 0-.51.1-.71.29L3.5 19.08l-.35-.34-1.44-1.45C1.51 17.1 1.26 17 1 17c-.13 0-.26.03-.38.08-.38.15-.62.52-.62.92v5c0 .55.45 1 1 1h5c.4 0 .77-.24.92-.62.16-.37.07-.8-.21-1.09l-1.45-1.44-.34-.35 4.788-4.79c.39-.39.39-1.03 0-1.42zM14.293 14.29c.2-.19.45-.29.71-.29.26 0 .51.1.71.29l4.79 4.79.35-.34 1.44-1.45c.197-.19.447-.29.707-.29.13 0 .26.03.38.08.38.15.62.52.62.92v5c0 .55-.45 1-1 1h-5c-.4 0-.77-.24-.92-.62-.16-.37-.07-.8.21-1.09l1.45-1.44.34-.35-4.788-4.79c-.39-.39-.39-1.03 0-1.42z"></path>
      </svg></div> 
    </button>

    <button id="playPauseButton" class="svgHeaderButton">
      <div id="playIcon">        
        <svg width="24" height="30" viewBox="0 0 24 30" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
          <path d="M4 7c0-2 2.2-3.2 3.9-2.1l14 9.5c1.5 1 1.5 3.2 0 4.2l-14 9.5C6.2 29.2 4 28 4 26V7z" />
        </svg>        

        </div> 
        <div id="pauseIcon">
          <svg width="24" height="34" viewBox="0 0 24 34" xmlns="http://www.w3.org/2000/svg" style="fill: currentColor;">
            <rect x="4" y="4" width="6" height="26" rx="2" />
            <rect x="14" y="4" width="6" height="26" rx="2" />
          </svg>
        </div>
    </button>
  </header>

  <div id="modalShare" class="modal hidden-display">
    <div class="modal-content share">
      <span id="closeModalShare" class="close-btn">&times;</span>
      <input type="text" id="urlInput" readonly>
      <button id="copyButton">Copy</button>
      <div id="shortenerMsg">Long link, using a link shortener is recommended</div>
    </div>
  </div>

  <div id="modalOptions" class="modal hidden-display">
    <div class="modal-content">
        <span id="closeModalOptions" class="close-btn">&times;</span>
        <div class="modal-body">
            <div class="tab-column">
                <button class="tab-button active" data-target="#changeSpeed">Timing</button>
                <button class="tab-button" data-target="#changeFontColor">Colors</button>
                <button class="tab-button" data-target="#changeFontStyle">Fonts</button>
                <button class="tab-button" data-target="#changeEffects">Effects</button>
                <button class="tab-button" data-target="#changeData">History</button>
                <button class="tab-button" data-target="#changeExtras">Extras</button>
                <button class="tab-button" data-target="#changeAbout">About</button>
            </div>
            <div class="tab-content">
                <div id="changeSpeed" class="tab active">
                  <div class="settingsRow"><label class="text" for="scrollDelay">Text scroll delay :</label><input type="number" min="0" id="scrollDelay"><label class="unit">(ms)</label></div>
                  <div class="settingsRow"><label class="text" for="fullStopDelay">Full stop delay :</label><input type="number" min="0" id="fullStopDelay"><label class="unit">(ms)</label></div>
                  <div class="settingsRow"><label class="text" for="nextPageDelay">Next page delay :</label><input type="number" min="0" id="nextPageDelay"><label class="unit">(ms)</label></div>
                  <div class="settingsRow" id="settingsDynamicPage"><label class="text" for="dynamicPageToggle">Less page delay on shorter pages :<input type="checkbox" id="dynamicPageToggle" /></div>
                  <div class="settingsRow settingsButtons"><button id="setDelayDefaults">Set Defaults</button></div>
                </div>
                <div id="changeFontColor" class="tab">
                  <div class="settingsRow"><label class="text" for="colorThemes-select">Theme :</label>
                    <select name="colorThemes" id="colorThemes-select">
                      <option value="dark">Dark</option>
                      <option value="light">Light</option>
                      <option value="sepia">Sepia</option>
                      <option value="olive">Green</option>
                      <option value="plastic">Plastic Beach</option>
                      <option value="custom1">-- custom 1 --</option>
                      <option value="custom2">-- custom 2 --</option>
                      <option value="custom3">-- custom 3 --</option>
                    </select>
                  </div>
                  <div class="settingsRow"><label class="text" for="fontBaseColor">Base text :</label><input type="color" id="fontBaseColor"></div>
                  <div class="settingsRow"><label class="text" for="fontQuoteColor">Quoted text :</label><input type="color" id="fontQuoteColor"></div>
                  <div class="settingsRow"><label class="text" for="BGColor">Background :</label><input type="color" id="BGColor"></div>
                  <div class="settingsRow settingsButtons"><button id="setColorDefaults">Reset Defaults</button></div>
                </div>
                <div id="changeFontStyle" class="tab">
                  <div class="settingsRow"><label class="text" for="font-select">Font :</label>
                    <select name="font" id="font-select">
                      <option value='"Libre Baskerville", serif'>Libre Baskerville</option>
                      <option value='"Merriweather", serif'>Merriweather</option>
                      <option value='"Georgia", serif'>Georgia</option>
                      <option value='"Times New Roman", serif'>Times New Roman</option>
                      <option value='"IBM Plex Serif", serif'>IBM Plex</option>
                      <option value='"Source Code Pro", serif'>Source Code Pro</option>
                    </select>
                  </div>
                  <div class="settingsRow"><label class="text" for="fontSize">Size :</label><input type="number" min="0.5" max="2.0" step="0.1" id="fontSize"><label class="unit">(em)</label></div>
                  <div class="settingsRow" id="settingsItalics"><label class="text" for="italicsToggle">Italicize quoted text :<input type="checkbox" id="italicsToggle" /></div>
                  <div class="settingsRow" id="settingsBold"><label class="text" for="boldToggle">Bold quoted text :<input type="checkbox" id="boldToggle" /></div>
                </div>
                <div id="changeEffects" class="tab">
                  <div class="settingsRow" id="settingsDropShadow"><label class="text" for="dropshadowToggle">Enable dropshadow :<input type="checkbox" id="dropshadowToggle" /></div>
                  <div class="settingsRow"><label class="text" for="effectThemes-select">Theme :</label>
                    <select name="effectThemes" id="effectThemes-select">
                      <option value="light3D">Light 3D</option>
                      <option value="dark3D">Dark 3D</option>
                      <option value="lightGhost">Light Ghost</option>
                      <option value="darkGhost">Dark Ghost</option>
                      <option value="vampire">Vampire</option>
                      <option value="mutagen">Mutagen</option>
                      <option value="custom1">-- custom 1 --</option>
                      <option value="custom2">-- custom 2 --</option>
                      <option value="custom3">-- custom 3 --</option>
                    </select>
                  </div>
                  <div class="settingsRow"><label class="text" for="applyTo-select">Add shadow to :</label>
                    <select name="applyTo" id="applyTo-select">
                      <option value="quoted">Quoted</option>
                      <option value="all">All Text</option>
                    </select>
                  </div>
                  <div class="settingsRow"><label class="text" for="XOffset">X-Offset :</label><input type="number" min="-100.0" max="100.0" step="0.1" id="XOffset"></div>
                  <div class="settingsRow"><label class="text" for="YOffset">Y-Offset :</label><input type="number" min="-100.0" max="100.0" step="0.1" id="YOffset"></div>
                  <div class="settingsRow"><label class="text" for="radius">Blur Radius :</label><input type="number" min="0.0" max="50.0" step="0.1" id="radius"></div>
                  <div class="settingsRow"><label class="text" for="dropshadowColor">Color :</label><input type="color" id="dropshadowColor"></div>
                  <div class="settingsRow settingsButtons"><button id="setShadowDefaults">Reset Defaults</button></div>
                </div>
                <div id="changeData" class="tab">
                  <ul id="storyList">
                  </ul>
                </div>
                <div id="changeExtras" class="tab">
                  <div class="settingsRow" id="settingsSanitize"><label class="text" for="sanitizeToggle">Sanitize text (remove html) :<input type="checkbox" id="sanitizeToggle" /></div>
                  <div class="settingsRow" id="settingsSanitize"><label class="text" for="splashToggle">Enable splash screen :<input type="checkbox" id="splashToggle" /></div>
                  <div class="settingsRow" id="settingsSanitize"><label class="text" for="splashToggle">Hide footer :<input type="checkbox" id="splashToggle" /></div>
                  <div class="settingsRow settingsButtons"><button id="clearAllCache">Clear all cache</button></div>
                  <label class="settingsDesc">
                    Delete all story data, reset all settings to default
                  </label>
                </div>
                <div id="changeAbout" class="tab">
                  <label class="settingsDesc">Made by Carter.<br><a href="mailto:carter@taleteller.io">carter@taleteller.io</a><br><br>
                  Privacy Policy:<br>All submitted user content is stored locally, only on your machine (and is not uploaded anywhere). TaleTeller.io does not collect, store, or share any personal data and does not use cookies or other tracking technologies.
                </label>
                </div>
            </div>
        </div>
    </div>
  </div>

  <main>
    <section id="addNewStory">
    <textarea id="storyTitle" placeholder="Title (Optional)"></textarea>
    <!-- <div id="storyTitle"><input type="text" placeholder="Title (Optional)"></div> -->
    <textarea id="storyInput" placeholder="---TaleTeller v1.0---
    
Paste your story here and hit the button below! It'll make pages out of each paragraph and scroll the words on each page, making it more immersive and fun to read than a wall of text. You can add different effects too, to make dialogue stand out for example. 

Nothing submitted is uploaded anywhere, it's all saved to your browser's storage. It'll save the page you're on too, if you close it out and come back.

 - Use the buttons at the top to change pages, or click on the text to go to the next page.

 - Left/right arrow keys should work too, spacebar will go to the next page.

 - Reload button on top left will clear the story to allow you to paste in a new one.

 - Play button will toggle auto-advancing to the next page after a delay.

 ((SCROLL DOWN))
 
 - Fullscreen button on top right will do what it's supposed to, unless it doesn't.

 - Options has a bunch of fun and useful things (WIP).

 - Leave this empty and hit the button to load a fun sample story from r/WritingPrompts (I'll update it every now and then)
 
 - Works pretty horribly on mobile, I'll make it better sometime.

 - I'll try my best not to break your custom settings and saved stories as I'm updating, but if they're messed up and refreshing doesn't work try going to Options -> Extras and purge local storage.
 
 TODO: Finish up Options menu, create a chrome extension to make copying and loading new stories easier.

 MAYBE: Allow for custom user fonts (like from Google fonts), have shared stories links contain custom themes (so like you open a story link for a spooky story, it overrides your settings and makes the loaded story look spooky)

 Made by Carter, carter@taleteller.io"></textarea>
    <div class="centeredButtons"><button id="storySubmit">Tell me a Tale</button></div>
    </section>
    <div id="display"></div>
  </main>

  <footer>
    <div id="footerAbout">About / Privacy Policy</div>
  </footer>

  <script src="libs/jquery.min.js"></script>
  <script type="text/javascript" src="libs/purify.min.js"></script>
  <script>
    let rawFonts = $('#splashFonts').attr("href").split("family");

    let loadedFonts = [];

    rawFonts.forEach((font, index) => {
      if (index > 0) {
        let t = font.replaceAll('=','').replaceAll('&','').replaceAll('+',' ').split(':')[0];
        let r = `"${t}", serif`;
        loadedFonts.push(r);
      }
    })

    const cssFonts = loadedFonts;

    function getRandomInt(max) {
        return Math.floor(Math.random() * max);
    }

    const splashTitle = document.getElementById("product-name");
    splashTitle.style.fontFamily = cssFonts[getRandomInt(cssFonts.length)];

  </script>

  <script src="https://cdn.jsdelivr.net/npm/pako@2.1.0/dist/pako.min.js"></script>
  <script src="index.js"></script>
</body>
</html>